---
layout: problem
site: AtCoder
prefix: ARC090 E
problem_name: Avoiding Collision
level: 700点
problem_url: https://atcoder.jp/contests/arc090/tasks/arc090_c
---
<h2>考察</h2>
<p>まず、$S$から各頂点への最短時間$d_s(v)$は、ダイクストラで求めることができます。このときに、$S$から各頂点に最短時間で行く方法の通り数$c_s(v)$も、ダイクストラに3行ほどコードを書き足すことで求めることが可能です。このときに使うアルゴリズムは、<a target="_blank" href="https://mathtrain.jp/dp">格子状のある交点からある交点に行く道順は何通りあるかを求めるアルゴリズム</a>です。</p>
<p>同様の方法で、$T$から各頂点への最短時間$d_t(v)$と、$T$から各頂点に最短時間で行く方法の通り数$c_t(v)$も求められます。</p>
<p>最終的に求めたいものは「二人が出会うことのないものの個数」です。これは、すべてのものの個数から、二人が出会うものの個数を引けばよいです。すべてのものの個数は$c_s(T)^2$（または$c_t(S)^2$）で求められます。二人が出会うものの個数ですが、頂点で出会うときと辺で出会うときとで場合分けして考えます。</p>
<p></p>
<h3>頂点で出会うとき</h3>
<p>$S$から$T$への最短時間を$X$とおくと、$d_s(v) = X/2$かつ$d_t(v) = X/2$であるような頂点$v$が、二人が出会う可能性のある頂点です。経路の個数は$(c_s(v) \times c_t(v))^2$です。この式は、高橋くんと青木くんの経路の選び方は完全に独立していること、$S$から$T$まで$v$を通って行く経路の個数は$c_s(v) \times c_t(v)$であることから導き出されます。</p>
<h3>辺で出会うとき</h3>
<p>ある辺$e$で出会うとき、$e$の端点を$v, u$とおくと、$(d_s(v) < X/2) \land (d_s(u) > X/2)$が成り立ちます。</p>
<h2>まとめ</h2>
<ul>
  <li>頂点で出会うときの経路の集合を$A$、辺で出会うときの経路の集合を$B$とおいたとき、$A$と$B$は必ず重ならないことが保障される</li>
  <li>難しいアルゴリズムを知らなくても、ダイクストラと道順を数える方法さえ知っていればこの問題は解ける（ただし道順を数える対象が格子でなくグラフなのでそこだけ注意）</li>
</ul>
