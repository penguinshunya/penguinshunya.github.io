# ARC085 E - MUL

[https://atcoder.jp/contests/arc085/tasks/arc085_c](https://atcoder.jp/contests/arc085/tasks/arc085_c)

後ろから貪欲に決めていく方法ではWAです。  
たとえば以下の入力を考えたとき、貪欲だと`0`ですが、正解は`4`です。  
（こちらの反例は、[解説動画](https://www.youtube.com/watch?v=D81e49n4Byc&t=2740s)のほうで挙げられていました）

```
6
-1 -5 -5 0 5 6
```

ということで別の解法を考える必要があるのですが、事前知識がないと解くのはほぼ不可能です。  
必要な事前知識は、最小カットに関する知識です。

## 最小カットで解ける問題は何か

最小カットとは何かを考える前に、最小カットで解ける問題は何かについて考えていきます。  
最小カットを使うことで、以下の問題を解くことができます。

* いくつかの頂点があります。頂点は、赤か青で塗られます
* ある頂点が赤、別のある頂点が青で塗られるとき、0円以上の罰金がかかります
* この条件のリストが与えられます
* 罰金の合計の最小値はいくらでしょうか

![イメージ的にはこんな感じ](arc085_e_001.svg)

逆にいうと、最小カットで解ける問題はこれだけです。  
しかし、頂点を追加したり条件をうまく言い換えることにより、様々な問題が解けるようになります。  
最小カットも、DPや累積和と同じように応用範囲の広いものだと言えます。

## 今回の問題を言い換える

どういったアルゴリズムを使って最小カットの問題を解くかについては一旦置いておきます。  
今回の問題を、上のほうにある箇条書きに当てはめてみます。

まず、宝石を割るか割らないかは、頂点を赤か青で塗ることに対応します。  
ということで今後は、宝石を頂点と呼び、割ることを赤で塗ると、割らないことを青で塗ると言うことにします。  

### a_i<0で青のとき

次にa_i<0の場合を考えます。  
a_i<0のとき、頂点iが青で塗られたときに-a_i円の罰金がかかります。  
これをそのまま箇条書きに当てはめようとしてもうまくいきません。  
なぜかというと、箇条書きの罰金というのは、2つの頂点の色によって決まるからです。  

* ある頂点が青のとき、いくらかの罰金がかかる
* ある頂点が赤、別のある頂点が青のとき、いくらかの罰金がかかる

この2つは、似ているようで違います。  
最小カットで解ける問題の条件は後者であり、前者はそのままでは解けません。

ここで、**必ず赤に塗られる頂点**を追加することにします。この頂点をSとします。  
すると「頂点iが青のとき、-a_i円の罰金がかかる」という条件は、「頂点Sが赤で頂点iが青のとき、-a_i円の罰金がかかる」というように言い換えることができます。  
言い換えることにより、箇条書きの2つ目に当てはめられる形になりました。
